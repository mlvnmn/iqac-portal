{% extends "base.html" %}
{% block title %}Recycle Bin - IQAC Portal{% endblock %}

{% block content %}
<div class="page-header">
    <div style="display: flex; align-items: center; gap: 1rem;">
        <a href="{{ url_for('sub_admin_dashboard') }}" class="btn btn-outline" title="Back">
            <i class="fas fa-arrow-left"></i>
        </a>
        <h1 style="margin: 0;"><i class="fas fa-trash-alt"></i> Recycle Bin</h1>
    </div>
</div>

<div class="card">
    <div class="section-title">
        <i class="fas fa-clock"></i>
        <h3>Rejected Submissions</h3>
        <span style="margin-left: auto;" class="text-muted" style="font-size: 0.8125rem;">
            Auto-deleted after 90 days
        </span>
    </div>

    {% if submissions %}
    <div class="grid">
        {% for sub in submissions %}
        <div class="card submission-card" style="opacity: 0.9; margin-bottom: 0;">
            {% if sub.image_filename %}
            <img src="{{ sub.image_filename }}" alt="{{ sub.event_type }}" loading="lazy">
            {% else %}
            <div
                style="height: 140px; display: flex; align-items: center; justify-content: center; background: var(--bg-primary); border-radius: var(--radius-md); margin-bottom: 1rem;">
                <i class="fas fa-file-alt" style="font-size: 2rem; color: var(--text-muted);"></i>
            </div>
            {% endif %}

            <h3>{{ sub.event_type }}</h3>

            <div class="meta">
                <div class="meta-item">
                    <i class="fas fa-user"></i>
                    <span>{{ sub.user.username }}</span>
                </div>
                <div class="meta-item">
                    <i class="fas fa-trash"></i>
                    <span>Rejected {{ sub.rejected_at.strftime('%b %d') }}</span>
                </div>
            </div>

            <div class="actions">
                <a href="{{ url_for('restore_submission', sub_id=sub.id) }}" class="btn btn-success btn-sm">
                    <i class="fas fa-undo"></i> Restore
                </a>
                <a href="{{ url_for('delete_permanent', sub_id=sub.id) }}" class="btn btn-danger btn-sm"
                    onclick="return confirm('Permanently delete? This cannot be undone.');">
                    <i class="fas fa-times"></i> Delete
                </a>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="empty-state">
        <i class="fas fa-trash"></i>
        <h3>Bin is Empty</h3>
        <p>No rejected submissions</p>
    </div>
    {% endif %}
</div>
{% endblock %}